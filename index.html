<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>Schrack-Seconet Host Übersicht</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
:root {
  --bg: #0f1115;
  --card-bg: #1d232b;
  --card-bg-hover: #25303b;
  --text: #f4f6f9;
  --accent: #3fa3ff;
  --accent-glow: #72c3ff;
  --border: #2e3944;
  --radius: 14px;
  --transition: 140ms ease;
  --grid-min: 190px;
  --ok: #31c878;
  --fail: #ff5562;
  --pending: #c9d3dd;
  --warn: #f5c04d;
  --font-stack: system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
}
* { box-sizing: border-box; }
html,body {
  margin:0;
  padding:0;
  font-family: var(--font-stack);
  background: linear-gradient(145deg,#0b0d11,#141a21 55%,#0d1014);
  color: var(--text);
  -webkit-font-smoothing: antialiased;
}
body { padding-top:10px; }
.logo-wrapper {
  display:flex;
  justify-content:center;
  align-items:center;
  margin:40px 0 20px;
}
.logo-wrapper img {
  width:180px;
  max-width:60%;
  height:auto;
  opacity:.9;
  filter:drop-shadow(0 4px 12px rgba(0,0,0,.4));
  transition:opacity .25s ease;
}
.logo-wrapper img:hover { opacity:1; }
h1 {
  font-weight:600;
  letter-spacing:.5px;
  text-align:center;
  margin:10px 0 8px;
  font-size:clamp(1.4rem,2.4vw,2rem);
}
p.subtitle {
  text-align:center;
  margin:0 0 24px;
  color:#b3bcc6;
  font-size:.95rem;
}
.wrapper {
  width: min(1600px, 94%);
  margin: 0 auto 70px;
}
.controls {
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  justify-content: center;
  margin-bottom:18px;
  align-items:center;
}
.controls input {
  background:#162027;
  color:var(--text);
  border:1px solid var(--border);
  padding:10px 14px;
  border-radius: 10px;
  outline:none;
  width: min(420px, 100%);
  font-size:.95rem;
  transition: var(--transition);
}
.controls input:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(63,163,255,.15);
}
.filter-group {
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.filter-btn {
  background:#162027;
  color:#c6d2dc;
  border:1px solid #25313b;
  padding:8px 14px 9px;
  font-size:.7rem;
  letter-spacing:.5px;
  text-transform:uppercase;
  border-radius: 999px;
  cursor:pointer;
  font-weight:600;
  display:inline-flex;
  align-items:center;
  gap:6px;
  transition: var(--transition);
  user-select:none;
}
.filter-btn:hover {
  background:#1e2a34;
  color:#e5eef5;
  border-color:#31404c;
}
.filter-btn.active {
  background: var(--accent);
  color:#07111a;
  border-color: var(--accent-glow);
  box-shadow:0 0 0 4px rgba(63,163,255,.25);
}
.filter-btn:focus-visible {
  outline:2px solid var(--accent);
  outline-offset:2px;
}
.refresh-btn {
  background:#20303b;
  color:#d2dde6;
  border:1px solid #30424e;
  padding:8px 14px;
  border-radius: 10px;
  font-size:.7rem;
  text-transform:uppercase;
  cursor:pointer;
  font-weight:600;
  letter-spacing:.7px;
  display:inline-flex;
  gap:6px;
  align-items:center;
  transition: var(--transition);
}
.refresh-btn:hover {
  background:#2a3c48;
  color:#fff;
}
.refresh-btn:focus-visible {
  outline:2px solid var(--accent);
  outline-offset:2px;
}
.badge-count {
  display:inline-flex;
  flex-wrap:wrap;
  align-items:center;
  gap:6px;
  font-size:.7rem;
  padding:4px 12px 5px;
  background:#182028;
  border:1px solid #27303b;
  border-radius:999px;
  color:#b7c3ce;
  white-space:nowrap;
  line-height:1.2;
}
.badge-count strong { font-weight:600; color:#fff; }
.grid {
  list-style:none;
  margin:0;
  padding:0;
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(var(--grid-min),1fr));
  gap:16px;
  align-items:stretch;
}
.grid > li { list-style:none; }
.tile {
  position:relative;
  background:var(--card-bg);
  border:1px solid var(--border);
  border-radius: var(--radius);
  padding:16px 14px 50px;
  display:flex;
  flex-direction:column;
  gap:10px;
  min-height:140px;
  cursor:pointer;
  text-decoration:none;
  color:var(--text);
  overflow:hidden;
  transition: var(--transition);
}
.tile:focus-visible {
  outline:2px solid var(--accent);
  outline-offset:2px;
}
.tile:hover {
  background:var(--card-bg-hover);
  border-color:#3a4753;
  transform:translateY(-4px);
  box-shadow:0 8px 18px -6px rgba(0,0,0,.55),0 0 0 1px rgba(255,255,255,.02);
}
.tile:active {
  transform:translateY(-1px) scale(.98);
}
.tile h2 {
  margin:0;
  font-size:.9rem;
  font-weight:600;
  line-height:1.3;
  word-break:break-word;
}
.tile small {
  font-size:.65rem;
  letter-spacing:.6px;
  text-transform:uppercase;
  color:#9aa6b2;
  display:flex;
  align-items:center;
  gap:6px;
  flex-wrap:wrap;
}
.status-chip {
  display:inline-flex;
  align-items:center;
  gap:6px;
  background:#1e2b33;
  padding:4px 8px 4px;
  border:1px solid #2a3944;
  border-radius: 8px;
  font-size:.6rem;
  font-weight:600;
  letter-spacing:.5px;
  color:#c7d4df;
  position:absolute;
  left:10px;
  bottom:10px;
  line-height:1;
  opacity:.95;
}
.status-chip[data-status="pending"] { color:var(--pending); }
.status-chip[data-status="online"]  { background:rgba(49,200,120,0.12); border-color:rgba(49,200,120,0.4); color:var(--ok); }
.status-chip[data-status="offline"] { background:rgba(255,85,98,0.12);  border-color:rgba(255,85,98,0.4);  color:var(--fail); }
.status-dot {
  width:9px; height:9px; border-radius:50%;
  background:var(--pending); position:relative;
}
.status-chip[data-status="online"] .status-dot { background:var(--ok); box-shadow:0 0 4px 1px rgba(49,200,120,.6); }
.status-chip[data-status="offline"] .status-dot { background:var(--fail); box-shadow:0 0 4px 1px rgba(255,85,98,.6); }
.open-icon {
  position:absolute;
  right:10px;
  bottom:10px;
  width:34px;
  height:34px;
  border-radius:10px;
  display:grid;
  place-items:center;
  background:#22303a;
  color:var(--accent);
  font-size:15px;
  transition: var(--transition);
  border:1px solid #2d3c47;
}
.tile:hover .open-icon {
  background: var(--accent);
  color:#09131b;
  border-color: var(--accent-glow);
  box-shadow:0 0 0 4px rgba(63,163,255,.25),0 0 0 1px #1e2d36;
}
.no-results {
  grid-column:1/-1;
  text-align:center;
  padding:50px 20px;
  border:2px dashed #2a3540;
  border-radius: var(--radius);
  font-size:.9rem;
  color:#92a1ae;
  backdrop-filter: blur(3px);
}
.info-hint {
  grid-column:1/-1;
  text-align:center;
  padding:20px 16px;
  font-size:.7rem;
  color:#7f8c95;
  letter-spacing:.3px;
}
footer {
  text-align:center;
  padding:30px 10px 60px;
  font-size:.7rem;
  color:#6d7984;
  max-width:900px;
  margin:0 auto;
  line-height:1.4;
}
@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; }
}
</style>
</head>
<body>
  <div class="logo-wrapper">
    <!-- Platzhalter-Bild (kann ersetzt werden durch echtes Logo) -->
    <img src="./SchrackSeconet_Logo_RGB_vertikal_negativ.png" alt="Schrack Seconet Logo Platzhalter">
  </div>
  <h1>Schrack‑Seconet Hosts</h1>
  <p class="subtitle">
    Klick auf eine Kachel öffnet den Host in einem neuen Tab. Insgesamt <span id="count-total"></span> Einträge.
  </p>
  <div class="wrapper">
    <div class="controls" role="radiogroup" aria-label="Host-Filter">
      <div class="filter-group">
        <button type="button" class="filter-btn active" data-filter="all" aria-pressed="true">Alle</button>
        <button type="button" class="filter-btn" data-filter="vorauerfriends" aria-pressed="false">VFC</button>
        <button type="button" class="filter-btn" data-filter="offline" aria-pressed="false">Offline</button>
        <button type="button" class="filter-btn" data-filter="onlineWithoutVorauerfriends" aria-pressed="false">Andere</button>
      </div>
      <input id="search" type="text" placeholder="Filter (Live-Suche) ..." aria-label="Host filtern" autocomplete="off" />
      <button type="button" id="refreshStatus" class="refresh-btn" title="Status aller (aktuellen) Hosts neu prüfen">
        ↻ Status neu
      </button>
      <span class="badge-count" id="shown-count"></span>
    </div>
    <ul class="grid" id="grid" aria-live="polite"></ul>
  </div>
  <footer>
    Generiert lokal – Datenbasis: bereitgestellte Zertifikatsliste & PDF (Subset „vorauerfriends“).
    Status-Check: clientseitiger Reachability-Test (Fetch + Favicon-Fallback, 7s Timeout). Ergebnisse können bei Spezial-Konfigurationen abweichen.
  </footer>

<script>
"use strict";

/* Hosts (unverändert gemäß Vorgabe) */
const hosts = [
  "7px3cgv2xtzhh5igcvh0grpru9rlzivn.schrack-seconet.com",
  "brand.schrack-seconet.com",
  "careers.schrack-seconet.com",
  "download.schrack-seconet.com",
  "edv.schrack-seconet.com",
  "files.schrack-seconet.com",
  "forallthatmatters.schrack-seconet.com",
  "future.schrack-seconet.com",
  "guest-redirect.schrack-seconet.com",
  "guest-wifi.schrack-seconet.com",
  "idpsop-test.schrack-seconet.com",
  "idpsop.schrack-seconet.com",
  "inotes.schrack-seconet.com",
  "inside.schrack-seconet.com",
  "integral-imap.schrack-seconet.com",
  "licenses-test.schrack-seconet.com",
  "licenses.schrack-seconet.com",
  "leitbild.schrack-seconet.com",
  "mail.schrack-seconet.com",
  "master.schrack-seconet.com",
  "missionstatement.schrack-seconet.com",
  "modern-healthcare.schrack-seconet.com",
  "new-era.schrack-seconet.com",
  "new-era2021.schrack-seconet.com",
  "news.schrack-seconet.com",
  "notes-p.wien.schrack-seconet.com",
  "pcvisit.schrack-seconet.com",
  "permissions-test.schrack-seconet.com",
  "permissions.schrack-seconet.com",
  "schrack-seconet.com",
  "schrack-seconet.com.cn",
  "schulung.schrack-seconet.com",
  "secoconfig.schrack-seconet.com",
  "serviceportal-test.schrack-seconet.com",
  "serviceportal.schrack-seconet.com",
  "showroom-test.schrack-seconet.com",
  "showroom.schrack-seconet.com",
  "showtime.schrack-seconet.com",
  "showtime2021.schrack-seconet.com",
  "solutions.schrack-seconet.com",
  "systems-test.schrack-seconet.com",
  "systems.schrack-seconet.com",
  "tendering-test.schrack-seconet.com",
  "tendering.schrack-seconet.com",
  "terminologie.schrack-seconet.com",
  "time.schrack-seconet.com",
  "training-test.schrack-seconet.com",
  "training.schrack-seconet.com",
  "traveler.schrack-seconet.com",
  "vm-hq.schrack-seconet.com",
  "vm-rz.schrack-seconet.com",
  "vpn-hq.schrack-seconet.com",
  "vpn-rz.schrack-seconet.com",
  "vs.schrack-seconet.com",
  "wesion.schrack-seconet.com",
  "www-test.schrack-seconet.com"
].sort((a,b)=>a.localeCompare(b));

/* vorauerfriends Set (erweitert gemäß Vorgabe) */
const vorauerfriendsSet = new Set([
  "brand.schrack-seconet.com",
  "careers.schrack-seconet.com",
  "forallthatmatters.schrack-seconet.com",
  "future.schrack-seconet.com",
  "inside.schrack-seconet.com",
  "integral-imap.schrack-seconet.com",
  "modern-healthcare.schrack-seconet.com",
  "new-era2021.schrack-seconet.com",
  "new-era.schrack-seconet.com",
  "news.schrack-seconet.com",
  "www.schrack-seconet.com",          /* Falls nicht in hosts-Liste, bleibt einfach ohne Auswirkung */
  "serviceportal-test.schrack-seconet.com",
  "serviceportal.schrack-seconet.com",
  "showroom-test.schrack-seconet.com",
  "solutions.schrack-seconet.com",
  "schrack-seconet.com",
  "schrack-seconet.com.cn",
  "showtime.schrack-seconet.com",
  "showroom.schrack-seconet.com",
  "showtime2021.schrack-seconet.com",
  "training.schrack-seconet.com",
  "wesion.schrack-seconet.com",
  "www-test.schrack-seconet.com"
]);

/* DOM Referenzen */
const grid = document.getElementById('grid');
const search = document.getElementById('search');
const shownCount = document.getElementById('shown-count');
const totalCount = document.getElementById('count-total');
const filterButtons = document.querySelectorAll('.filter-btn');
const refreshBtn = document.getElementById('refreshStatus');

let activeFilter = 'all';
totalCount.textContent = hosts.length;

/* Status Cache */
const statusCache = {};
const statusInFlight = new Set();
let rerenderTimeout = null;

/* Hilfsfunktionen */
function environmentLabel(host) {
  return host.includes('test') || host.includes('vm-') ? 'Test / Spezial' :
         host.includes('vpn-') ? 'VPN Endpoint' :
         host.includes('guest') ? 'Guest / Access' :
         host.includes('training') || host.includes('schulung') ? 'Training' :
         host.includes('serviceportal') ? 'Serviceportal' :
         host.includes('showroom') ? 'Showroom' :
         host.includes('idpsop') ? 'IDP / SSO' :
         host.includes('systems') ? 'Systems' :
         host.includes('tendering') ? 'Tendering' :
         host.includes('licenses') ? 'Licenses' :
         host.includes('permissions') ? 'Permissions' :
         host.includes('future') ? 'Future' :
         host.includes('www') ? 'WWW' :
         'Host';
}

function makeTile(host) {
  if (!statusCache[host]) statusCache[host] = 'pending';
  const li = document.createElement('li');
  const a = document.createElement('a');
  a.href = "https://" + host;
  a.target = "_blank";
  a.rel = "noopener noreferrer";
  a.className = "tile";
  a.dataset.host = host.toLowerCase();
  if (vorauerfriendsSet.has(host)) a.dataset.vorauerfriends = "true";

  const title = document.createElement('h2');
  title.textContent = host;

  const env = document.createElement('small');
  env.textContent = environmentLabel(host);

  const chip = document.createElement('span');
  chip.className = 'status-chip';
  chip.dataset.status = statusCache[host];
  chip.title = 'Status: ' + statusCache[host];
  chip.innerHTML = `<span class="status-dot"></span><span class="status-text">${statusCache[host].toUpperCase()}</span>`;

  const icon = document.createElement('div');
  icon.className = 'open-icon';
  icon.setAttribute('aria-hidden','true');
  icon.innerHTML = '↗';

  a.appendChild(title);
  a.appendChild(env);
  a.appendChild(icon);
  a.appendChild(chip);
  li.appendChild(a);
  return li;
}

function currentBaseList() {
  switch (activeFilter) {
    case 'vorauerfriends':
      return hosts.filter(h => vorauerfriendsSet.has(h));
    case 'offline':
      return hosts.filter(h => statusCache[h] === 'offline');
    case 'onlineWithoutVorauerfriends':
      return hosts.filter(h => statusCache[h] === 'online' && !vorauerfriendsSet.has(h));
    default:
      return hosts;
  }
}

function render(filterText = "") {
  const f = filterText.trim().toLowerCase();
  grid.innerHTML = '';
  const base = currentBaseList();
  let shown = 0;
  base.forEach(h => {
    if (!f || h.toLowerCase().includes(f)) {
      grid.appendChild(makeTile(h));
      shown++;
    }
  });

  if (shown === 0) {
    const div = document.createElement('div');
    div.className = 'no-results';
    if ((activeFilter === 'offline' || activeFilter === 'onlineWithoutVorauerfriends') &&
        Object.values(statusCache).some(st => st === 'pending')) {
      div.textContent = 'Noch keine passenden Ergebnisse – Status-Prüfung läuft...';
    } else {
      div.textContent = 'Keine Treffer für "' + filterText + '" im aktuellen Filter.';
    }
    grid.appendChild(div);
  }

  if (activeFilter === 'offline' || activeFilter === 'onlineWithoutVorauerfriends') {
    const hint = document.createElement('div');
    hint.className = 'info-hint';
    hint.textContent = 'Dynamischer Filter: Ergebnisse erscheinen/aktualisieren sich sobald Status ermittelt wurde.';
    grid.appendChild(hint);
  }

  updateShownBadge();
  scheduleVisibleStatusChecks();
}

function updateShownBadge() {
  const base = currentBaseList();
  const visibleTiles = grid.querySelectorAll('.tile');
  let onlineCount = 0, offlineCount = 0, pendingCount = 0;
  visibleTiles.forEach(t => {
    const hostLower = t.dataset.host;
    const original = hosts.find(h=>h.toLowerCase()===hostLower);
    const st = statusCache[original] || 'pending';
    if (st === 'online') onlineCount++;
    else if (st === 'offline') offlineCount++;
    else pendingCount++;
  });
  let filterLabel = '';
  if (activeFilter === 'vorauerfriends') filterLabel = ' | Filter: vorauerfriends';
  else if (activeFilter === 'offline') filterLabel = ' | Filter: Offline';
  else if (activeFilter === 'onlineWithoutVorauerfriends') filterLabel = ' | Filter: Online ohne vorauerfriends';

  shownCount.innerHTML = `
    <strong>${visibleTiles.length}</strong> / ${base.length} sichtbar
    &nbsp;|&nbsp; <span style="color:var(--ok)">ONLINE ${onlineCount}</span>
    &nbsp;|&nbsp; <span style="color:var(--fail)">OFFLINE ${offlineCount}</span>
    ${pendingCount ? '&nbsp;|&nbsp; PENDING ' + pendingCount : ''}${filterLabel}
  `;
}

function updateTileStatus(host, status) {
  statusCache[host] = status;
  const selector = `.tile[data-host="${CSS.escape(host.toLowerCase())}"] .status-chip`;
  const el = document.querySelector(selector);
  if (el) {
    el.dataset.status = status;
    el.title = 'Status: ' + status;
    el.querySelector('.status-text').textContent = status.toUpperCase();
  }
  updateShownBadge();

  if (activeFilter === 'offline' || activeFilter === 'onlineWithoutVorauerfriends') {
    if (!rerenderTimeout) {
      rerenderTimeout = setTimeout(() => {
        rerenderTimeout = null;
        render(search.value);
      }, 400);
    }
  }
}

async function checkHost(host) {
  if (statusInFlight.has(host)) return;
  statusInFlight.add(host);
  updateTileStatus(host, 'pending');

  const timeoutMs = 7000;
  const controller = new AbortController();
  const timeout = setTimeout(()=>controller.abort(), timeoutMs);

  try {
    await fetch('https://' + host + '/', {
      method: 'GET',
      mode: 'no-cors',
      signal: controller.signal,
      cache: 'no-store'
    });
    clearTimeout(timeout);
    updateTileStatus(host, 'online');
    statusInFlight.delete(host);
    return;
  } catch (e) {
    clearTimeout(timeout);
    await new Promise(resolve => {
      const img = new Image();
      const done = (ok) => {
        updateTileStatus(host, ok ? 'online' : 'offline');
        resolve();
      };
      const t = setTimeout(()=>done(false), 5000);
      img.onload = () => { clearTimeout(t); done(true); };
      img.onerror = () => { clearTimeout(t); done(false); };
      img.src = 'https://' + host + '/favicon.ico?ping=' + Date.now();
    });
  } finally {
    statusInFlight.delete(host);
  }
}

function scheduleVisibleStatusChecks() {
  const visibleHosts = Array.from(document.querySelectorAll('.tile')).map(t => t.dataset.host);
  const toCheck = visibleHosts
    .map(lower => hosts.find(h => h.toLowerCase() === lower))
    .filter(h => h && statusCache[h] === 'pending');
  runBatchChecks(toCheck);
}

function scheduleAllStatusChecks() {
  const toCheck = hosts.filter(h => statusCache[h] === 'pending');
  runBatchChecks(toCheck);
}

function runBatchChecks(list) {
  if (!list.length) return;
  const concurrency = 6;
  let idx = 0;
  function next() {
    if (idx >= list.length) return;
    const batch = list.slice(idx, idx + concurrency);
    idx += concurrency;
    batch.forEach(h => checkHost(h));
    if (idx < list.length) setTimeout(next, 300);
  }
  next();
}

function ensureAllStatuses() {
  hosts.forEach(h => { if (!statusCache[h]) statusCache[h] = 'pending'; });
  scheduleAllStatusChecks();
}

function recheckVisible(forceAll=false) {
  const visibleHosts = Array.from(document.querySelectorAll('.tile')).map(t => t.dataset.host);
  visibleHosts.forEach(hLower => {
    const original = hosts.find(h=>h.toLowerCase()===hLower);
    if (!original) return;
    if (forceAll) statusCache[original] = 'pending';
  });
  render(search.value);
}

/* Events */
filterButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    const newFilter = btn.dataset.filter;
    if (newFilter === activeFilter) return;
    activeFilter = newFilter;
    filterButtons.forEach(b => {
      const isActive = b === btn;
      b.classList.toggle('active', isActive);
      b.setAttribute('aria-pressed', isActive ? 'true' : 'false');
    });
    if (activeFilter === 'offline' || activeFilter === 'onlineWithoutVorauerfriends') {
      ensureAllStatuses();
    }
    render(search.value);
  });
});

search.addEventListener('input', e => render(e.target.value));

refreshBtn.addEventListener('click', () => {
  if (activeFilter === 'offline' || activeFilter === 'onlineWithoutVorauerfriends') {
    hosts.forEach(h => statusCache[h] = 'pending');
    ensureAllStatuses();
    render(search.value);
  } else {
    recheckVisible(true);
  }
});

/* Initial Start */
render();
</script>
</body>
</html>
